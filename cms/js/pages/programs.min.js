"use strict";$(document).ready(function(){var a;$(document).find("table").DataTable({dom:"Bfrtip",buttons:[],columnDefs:[{orderable:true,targets:"_all"},{className:"text-left",targets:"_all"}],order:[[2,"asc"]],searching:true,info:true,paging:true,language:{}});$('[data-action="get"]').on("click",function(){a=$(this).data("id");$.ajax({url:"",type:"POST",data:"id="+a+"&action=get",processData:false,cache:false,dataType:"json",success:function(b){if(b.status=="success"){$('input[name="name_es"]').val(b.data.name.es);$('input[name="name_en"]').val(b.data.name.en);$('textarea[name="description_es"]').val(b.data.description.en);$('textarea[name="description_en"]').val(b.data.description.en);$('input[name="cover"]').parents(".uploader").find("figure[data-preview] > img").attr("src","../uploads/"+b.data.cover);$('input[name="priority"]').val(b.data.priority);$('input[name="seo_keywords_es"]').val(b.data.seo.keywords.es);$('input[name="seo_keywords_en"]').val(b.data.seo.keywords.es);$('input[name="seo_description_es"]').val(b.data.seo.description.es);$('input[name="seo_description_en"]').val(b.data.seo.description.en);$('[data-modal="datas"] header > h4').html("Detalles | Editar");$('[data-modal="datas"] main > form').attr("data-submit-action","edit");$('[data-modal="datas"]').addClass("view").animate({scrollTop:0},0)}else{$('[data-modal="alert"] main > p').html(b.message);$('[data-modal="alert"]').addClass("view").animate({scrollTop:0},0)}}})});$('[data-modal="datas"]').modal().onSuccess(function(){$('form[name="datas"]').submit()});$('[data-modal="datas"]').modal().onCancel(function(){$("figure[data-preview] > img").attr("src","../images/empty.png");$('[data-modal="datas"] header > h4').html("Nuevo");$('[data-modal="datas"] main > form').attr("data-submit-action","new");$('[data-modal="datas"] main > form')[0].reset();$('[data-modal="datas"] main > form [name]').parent().removeClass("error");$('[data-modal="datas"] main > form [name]').parent().find("p.error").remove()});$('form[name="datas"]').on("submit",function(c){c.preventDefault();tinyMCE.triggerSave();var b=new FormData(this);b.append("id",a);b.append("action",$(this).data("submit-action"));$.ajax({url:"",type:"POST",data:b,contentType:false,processData:false,cache:false,dataType:"json",success:function(d){checkFormValidations($(this),d,function(){$('[data-modal="datas"]').removeClass("view").animate({scrollTop:0},0);$('[data-modal="success"] main > p').html(d.message);$('[data-modal="success"]').addClass("view").animate({scrollTop:0},0)})}})});$('[data-action="delete"]').on("click",function(){a=$(this).data("id");$('[data-modal="delete"]').addClass("view").animate({scrollTop:0},0)});$('[data-modal="delete"]').modal().onSuccess(function(){$.ajax({url:"",type:"POST",data:"id="+a+"&action=delete",processData:false,cache:false,dataType:"json",success:function(b){$('[data-modal="delete"]').removeClass("view").animate({scrollTop:0},0);if(b.status=="success"){$('[data-modal="success"] main > p').html(b.message);$('[data-modal="success"]').addClass("view").animate({scrollTop:0},0)}else{$('[data-modal="alert"] main > p').html(b.message);$('[data-modal="alert"]').addClass("view").animate({scrollTop:0},0)}}})});$('[data-action="new"]').on("click",function(){$('input[name="new"]').click()});$('input[name="new"]').on("change",function(){if($(this)[0].files[0].type.match($(this).attr("accept"))){var b=new FileReader();b.onload=function(c){$.ajax({url:"",type:"POST",data:"image="+c.target.result+"&action=new",processData:false,cache:false,dataType:"json",success:function(d){if(d.status=="success"){$("body").prepend('<div data-ajax-loader><div class="loader"></div></div>');location.reload()}else{$('[data-modal="alert"] main > p').html(d.message);$('[data-modal="alert"]').addClass("view").animate({scrollTop:0},0)}}})};b.readAsDataURL($(this)[0].files[0])}else{$('[data-modal="alert"] main > p').html("Archivo no permitido");$('[data-modal="alert"]').addClass("view").animate({scrollTop:0},0)}})});